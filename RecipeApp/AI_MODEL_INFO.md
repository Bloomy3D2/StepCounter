# ü§ñ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ AI –º–æ–¥–µ–ª–∏

## –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—É—é —Å–∏—Å—Ç–µ–º—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ—Ü–µ–ø—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∞–≤–∏–ª –∏ —à–∞–±–ª–æ–Ω–æ–≤**, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω–∞—è AI –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ –±–æ–ª—å—à–∏—Ö ML –º–æ–¥–µ–ª—è—Ö.

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π (RecipeKnowledgeBase)**
   - –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
   - –®–∞–±–ª–æ–Ω—ã –Ω–∞–∑–≤–∞–Ω–∏–π —Ä–µ—Ü–µ–ø—Ç–æ–≤
   - –ú–µ—Ç–æ–¥—ã –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è
   - –¢–∏–ø–∏—á–Ω—ã–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
   - –°–∏–Ω–æ–Ω–∏–º—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤

2. **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ä–µ—Ü–µ–ø—Ç–æ–≤ (RecipeGenerator)**
   - –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –±–ª—é–¥–∞
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ —à–∞–±–ª–æ–Ω–∞–º
   - –°–æ–∑–¥–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏ –ø–æ—Ä—Ü–∏–∏

3. **Natural Language Framework**
   - –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
   - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π
   - –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω** - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞  
‚úÖ **–ë—ã—Å—Ç—Ä–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è** - –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç  
‚úÖ **–ú–∞–ª–µ–Ω—å–∫–∏–π —Ä–∞–∑–º–µ—Ä** - –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç –≥–∏–≥–∞–±–∞–π—Ç—ã –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é  
‚úÖ **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ** - –≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã  
‚úÖ **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ Core ML** - –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å  

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–π Core ML –º–æ–¥–µ–ª–∏

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ—Ü–µ–ø—Ç–æ–≤:

1. **LLaMA 2/3 7B** (–∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–Ω–∞—è)
   - –†–∞–∑–º–µ—Ä: ~4 GB (Q4_0)
   - –ö–∞—á–µ—Å—Ç–≤–æ: –û—Ç–ª–∏—á–Ω–æ–µ
   - –°–∫–æ—Ä–æ—Å—Ç—å: –°—Ä–µ–¥–Ω—è—è

2. **Mistral 7B** (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)
   - –†–∞–∑–º–µ—Ä: ~4 GB
   - –ö–∞—á–µ—Å—Ç–≤–æ: –û—Ç–ª–∏—á–Ω–æ–µ
   - –°–∫–æ—Ä–æ—Å—Ç—å: –ë—ã—Å—Ç—Ä–∞—è (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)

3. **Phi-2** (Microsoft)
   - –†–∞–∑–º–µ—Ä: ~2 GB
   - –ö–∞—á–µ—Å—Ç–≤–æ: –•–æ—Ä–æ—à–µ–µ
   - –°–∫–æ—Ä–æ—Å—Ç—å: –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è

### –®–∞–≥ 2: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Core ML

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ llama.cpp

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º llama.cpp
git clone https://github.com/ggerganov/llama.cpp
cd llama.cpp

# –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥–µ–ª—å
python convert-llama-to-coreml.py \
    --model-dir ./models/llama-7b \
    --output-dir ./models/coreml \
    --quantization q4_0 \
    --outtype f16
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ coremltools

```python
import coremltools as ct

# –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å (–ø—Ä–∏–º–µ—Ä –¥–ª—è PyTorch)
import torch
model = torch.load("recipe_model.pth")

# –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º
mlmodel = ct.convert(
    model,
    inputs=[ct.TensorType(name="input", shape=(1, 512))],
    outputs=[ct.TensorType(name="output")]
)

# –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
mlmodel = ct.models.neural_network.quantization_utils.quantize_weights(
    mlmodel, nbits=4
)

# –°–æ—Ö—Ä–∞–Ω—è–µ–º
mlmodel.save("RecipeGenerator.mlmodelc")
```

### –®–∞–≥ 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –ø—Ä–æ–µ–∫—Ç

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.mlmodelc` —Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É `RecipeApp/`
2. –î–æ–±–∞–≤—å—Ç–µ –≤ Xcode –ø—Ä–æ–µ–∫—Ç
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ Target
4. –ú–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

### –®–∞–≥ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞

–ö–æ–¥ —É–∂–µ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! –ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ –º–æ–¥–µ–ª—å –≤ –ø—Ä–æ–µ–∫—Ç, –∏ `LocalAIService` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç –µ—ë.

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –æ–±–Ω–æ–≤–∏—Ç–µ –º–µ—Ç–æ–¥ `generateWithModel()` –≤ `LocalAIService.swift`.

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏

### –ö–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ

–î–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ:

- **Q4_0**: 4 –±–∏—Ç–∞, —Ä–∞–∑–º–µ—Ä ~4 GB, –∫–∞—á–µ—Å—Ç–≤–æ —Ö–æ—Ä–æ—à–µ–µ
- **Q4_1**: 4 –±–∏—Ç–∞ —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏, —Ä–∞–∑–º–µ—Ä ~4.5 GB
- **Q5_0**: 5 –±–∏—Ç, —Ä–∞–∑–º–µ—Ä ~5 GB, –∫–∞—á–µ—Å—Ç–≤–æ –ª—É—á—à–µ
- **Q8_0**: 8 –±–∏—Ç, —Ä–∞–∑–º–µ—Ä ~8 GB, –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–ª–∏—á–Ω–æ–µ

### Compute Units

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `MLModelConfiguration`:

```swift
let config = MLModelConfiguration()

// CPU —Ç–æ–ª—å–∫–æ (—Å–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ)
config.computeUnits = .cpuOnly

// CPU + Neural Engine (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è iPhone)
config.computeUnits = .cpuAndNeuralEngine

// –í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ (CPU + Neural Engine + GPU)
config.computeUnits = .all
```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã

### 1. On-Demand Resources

–î–ª—è –±–æ–ª—å—à–∏—Ö –º–æ–¥–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ On-Demand Resources:

```swift
// –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
let resourceRequest = NSBundleResourceRequest(tags: ["RecipeModel"])
resourceRequest.beginAccessingResources { error in
    if error == nil {
        // –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
    }
}
```

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞

–ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –º–æ–¥–µ–ª—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏:

```swift
func downloadModel() async throws {
    let url = URL(string: "https://your-server.com/RecipeGenerator.mlmodelc")!
    let (data, _) = try await URLSession.shared.data(from: url)
    
    let documentsPath = FileManager.default.urls(for: .documentDirectory, in: .userDomainMask)[0]
    let modelURL = documentsPath.appendingPathComponent("RecipeGenerator.mlmodelc")
    
    try data.write(to: modelURL)
}
```

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

‚úÖ –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π —Å–æ–∑–¥–∞–Ω–∞  
‚úÖ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ä–µ—Ü–µ–ø—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω  
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Core ML –¥–æ–±–∞–≤–ª–µ–Ω–∞  
‚úÖ Fallback –Ω–∞ –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚è≥ –û–∂–∏–¥–∞–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è Core ML –º–æ–¥–µ–ª–∏  

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

–î–ª—è –Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–∫—É—â—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é (–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∞–≤–∏–ª). –û–Ω–∞:
- –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
- –ë—ã—Å—Ç—Ä–∞—è –∏ –Ω–∞–¥–µ–∂–Ω–∞—è

–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –±–æ–ª–µ–µ –∫—Ä–µ–∞—Ç–∏–≤–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –¥–æ–±–∞–≤—å—Ç–µ Core ML –º–æ–¥–µ–ª—å –ø–æ–∑–∂–µ.
