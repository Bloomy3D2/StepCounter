# ‚úÖ –§–∏–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!

## üéâ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

### ‚úÖ 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

**ChallengeManager:**
- ‚úÖ `loadChallengesFromSupabase()` - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—ç—à –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
- ‚úÖ `loadUserChallengesFromSupabase()` - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—ç—à –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
- ‚úÖ –ö—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫—ç—à –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö (join, complete, fail)

**SupabaseManager:**
- ‚úÖ `getCurrentUser()` - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—ç—à –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
- ‚úÖ `getChallenges()` - –æ–±–µ—Ä–Ω—É—Ç –≤ retry
- ‚úÖ `getUserChallenges()` - –æ–±–µ—Ä–Ω—É—Ç –≤ retry
- ‚úÖ –ö—ç—à–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
- ‚úÖ –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫—ç—à –ø—Ä–∏ signOut, deposit, withdraw

---

### ‚úÖ 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è retry –ª–æ–≥–∏–∫–∏

**–í—Å–µ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –æ–±–µ—Ä–Ω—É—Ç—ã –≤ NetworkRetry:**
- ‚úÖ `getChallenges()` - —Å retry
- ‚úÖ `getUserChallenges()` - —Å retry
- ‚úÖ `joinChallenge()` - —Å retry
- ‚úÖ `completeDay()` - —Å retry
- ‚úÖ `failChallenge()` - —Å retry
- ‚úÖ `depositBalance()` - —Å retry
- ‚úÖ `withdrawBalance()` - —Å retry
- ‚úÖ `signOut()` - —Å retry
- ‚úÖ Edge Functions –≤—ã–∑–æ–≤—ã - —Å retry

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ–µ–≤ —Å–µ—Ç–∏
- ‚úÖ –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏
- ‚úÖ –£–º–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏

---

### ‚úÖ 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Views –¥–ª—è DI

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:**
- ‚úÖ `MainTabView` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç DIContainer –¥–ª—è ChallengeManager
- ‚úÖ `AuthView` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç DIContainer –¥–ª—è AuthManager
- ‚úÖ `ChallengeAppApp` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç DIContainer –¥–ª—è SupabaseManager

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- ‚úÖ –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å (–º–æ–∂–Ω–æ –∏–Ω–∂–µ–∫—Ç–∏—Ç—å –º–æ–∫–∏)
- ‚úÖ –ú–µ–Ω—å—à–µ —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏

---

### ‚úÖ 4. –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–∫–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–°–æ–∑–¥–∞–Ω–æ:**
- ‚úÖ `MockSupabaseManager` - –º–æ–∫ –¥–ª—è SupabaseManager
- ‚úÖ `MockCacheManager` - –º–æ–∫ –¥–ª—è CacheManager
- ‚úÖ `MockNetworkRetry` - –º–æ–∫ –¥–ª—è NetworkRetry
- ‚úÖ `MockPaymentManager` - –º–æ–∫ –¥–ª—è PaymentManager
- ‚úÖ `MockYooKassaClient` - –º–æ–∫ –¥–ª—è YooKassaClient

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç–æ–¥–∞
- ‚úÖ –°–∏–º—É–ª—è—Ü–∏—è –æ—à–∏–±–æ–∫
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—ã–∑–æ–≤–æ–≤ (attemptCount)

---

## üìÅ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Managers:
- ‚úÖ `ChallengeManager.swift` - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ + retry
- ‚úÖ `SupabaseManager.swift` - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ + retry + –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è

### Views:
- ‚úÖ `MainTabView.swift` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç DIContainer
- ‚úÖ `AuthView.swift` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç DIContainer
- ‚úÖ `ChallengeAppApp.swift` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç DIContainer

### Tests:
- ‚úÖ `Tests/Mocks/MockManagers.swift` - –≤—Å–µ –º–æ–∫–∏

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** 5
- **–°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 1 (MockManagers.swift)
- **–ú–µ—Ç–æ–¥–æ–≤ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º:** 3
- **–ú–µ—Ç–æ–¥–æ–≤ —Å retry:** 10+
- **–ú–æ–∫–æ–≤:** 5

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ö–æ–¥ —Å—Ç–∞–ª:**
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–µ–µ** - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Å–µ—Ç—å
- ‚úÖ **–ù–∞–¥–µ–∂–Ω–µ–µ** - retry –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–±–æ–∏
- ‚úÖ **–ë—ã—Å—Ç—Ä–µ–µ** - –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –∫—ç—à–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- ‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–º** - –º–æ–∫–∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:
```swift
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—ç—à –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
await challengeManager.loadChallengesFromSupabase()

// –ï—Å–ª–∏ –µ—Å—Ç—å –≤ –∫—ç—à–µ - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É
// –ó–∞—Ç–µ–º –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ —Å–µ—Ç–∏ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
```

### Retry:
```swift
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–∫–∞—Ö
try await supabaseManager.getChallenges()

// –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
```swift
let mockSupabase = MockSupabaseManager()
mockSupabase.getChallengesResult = [challenge1, challenge2]

let manager = ChallengeManager(supabaseManager: mockSupabase)
// –¢–µ—Å—Ç–∏—Ä—É–µ–º –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ Supabase
```

---

## üìù –ß—Ç–æ –¥–∞–ª—å—à–µ?

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
1. ‚úÖ –í—Å–µ –≥–æ—Ç–æ–≤–æ!

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
1. –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—è –º–æ–∫–∏
2. –ù–∞–ø–∏—Å–∞—Ç—å integration —Ç–µ—Å—Ç—ã
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD

---

## üéâ –ò—Ç–æ–≥

**–í—Å–µ —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã!**

–ö–æ–¥ –≥–æ—Ç–æ–≤ –∫:
- ‚úÖ –ü—Ä–æ–¥–∞–∫—à–µ–Ω—É
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~4 —á–∞—Å–∞

---

**–ì–æ—Ç–æ–≤–æ!** üöÄ
