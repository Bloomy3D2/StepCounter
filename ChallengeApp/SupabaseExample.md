# –ü—Ä–∏–º–µ—Ä: –ö–∞–∫ Supabase –∑–∞–º–µ–Ω–∏—Ç Java Backend

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å Supabase:

```
iOS App
   ‚Üì
Supabase Client SDK
   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Supabase                    ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ  PostgreSQL Database      ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  (—Ç–∞–±–ª–∏—Ü—ã –∫–∞–∫ –≤ Java)     ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ  Supabase Auth              ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  (–∑–∞–º–µ–Ω–∞ JWT)               ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ  Edge Functions              ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  (–∑–∞–º–µ–Ω–∞ Java —Å–µ—Ä–≤–∏—Å–æ–≤)      ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ  Realtime                    ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  (–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º      ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ   –≤—Ä–µ–º–µ–Ω–∏)                   ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å:

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

**Java:**
```java
@Entity
public class User {
    @Id
    @GeneratedValue
    private Long id;
    private String email;
    private Double balance;
}
```

**Supabase:**
```sql
-- –¢–∞ –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞!
CREATE TABLE users (
    id BIGSERIAL PRIMARY KEY,
    email TEXT UNIQUE NOT NULL,
    balance DECIMAL DEFAULT 0.0
);
```

‚úÖ **–ü–æ—á—Ç–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ!**

---

### 2. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–ø—Ä–æ—â–µ!)

**Java:**
```java
@PostMapping("/api/auth/login")
public AuthResponse login(@RequestBody LoginRequest request) {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT
    // –í–æ–∑–≤—Ä–∞—Ç —Ç–æ–∫–µ–Ω–∞
}
```

**Supabase:**
```swift
// iOS –∫–æ–¥
let response = try await supabase.auth.signIn(
    email: email,
    password: password
)
// –ì–æ—Ç–æ–≤–æ! –¢–æ–∫–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

‚úÖ **–ù–∞–º–Ω–æ–≥–æ –ø—Ä–æ—â–µ!**

---

### 3. –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (–Ω—É–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å)

**Java:**
```java
@PostMapping("/api/challenges/{id}/join")
public UserChallengeDto joinChallenge(...) {
    // –í—Å—è –ª–æ–≥–∏–∫–∞ –≤ Java
}
```

**Supabase:**
```typescript
// Edge Function (Deno/TypeScript)
Deno.serve(async (req) => {
    const { userId, challengeId } = await req.json();
    
    // –¢–∞ –∂–µ –ª–æ–≥–∏–∫–∞, –Ω–æ –Ω–∞ TypeScript
    const user = await supabase
        .from('users')
        .select('*')
        .eq('id', userId)
        .single();
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
    if (user.balance < challenge.entryFee) {
        return new Response('Insufficient balance', { status: 400 });
    }
    
    // –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è
    await supabase.rpc('join_challenge', {
        user_id: userId,
        challenge_id: challengeId
    });
    
    return new Response(JSON.stringify(result));
});
```

‚ö†Ô∏è **–ù—É–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –Ω–∞ TypeScript, –Ω–æ –ª–æ–≥–∏–∫–∞ —Ç–∞ –∂–µ**

---

### 4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏

**Java:**
```java
@Scheduled(cron = "0 0 0 * * *")
public void checkFailedChallenges() { ... }
```

**Supabase:**
```sql
-- PostgreSQL —Ñ—É–Ω–∫—Ü–∏—è
CREATE OR REPLACE FUNCTION check_failed_challenges()
RETURNS void AS $$
BEGIN
    -- –¢–∞ –∂–µ –ª–æ–≥–∏–∫–∞
END;
$$ LANGUAGE plpgsql;

-- pg_cron
SELECT cron.schedule(
    'check-failed-daily',
    '0 0 * * *',
    $$SELECT check_failed_challenges()$$
);
```

‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ**

---

## –ö–æ–¥ –¥–ª—è iOS (Supabase):

```swift
import Supabase

class ChallengeService {
    let supabase = SupabaseClient(
        supabaseURL: URL(string: "https://your-project.supabase.co")!,
        supabaseKey: "your-anon-key"
    )
    
    // –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ —á–µ–ª–ª–µ–Ω–¥–∂—É
    func joinChallenge(challengeId: Int) async throws {
        // –í—ã–∑–æ–≤ Edge Function
        let response = try await supabase.functions
            .invoke("join-challenge", body: [
                "challengeId": challengeId
            ])
    }
    
    // –ü–æ–ª—É—á–∏—Ç—å —á–µ–ª–ª–µ–Ω–¥–∂–∏
    func getChallenges() async throws -> [Challenge] {
        let response = try await supabase
            .from("challenges")
            .select("*")
            .execute()
        
        return try JSONDecoder().decode([Challenge].self, from: response.data)
    }
}
```

---

## –ò–¢–û–ì:

### ‚úÖ Supabase –ó–ê–ú–ï–ù–Ø–ï–¢:
- ‚úÖ –ë–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (100%)
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (100%, –¥–∞–∂–µ –ø—Ä–æ—â–µ)
- ‚úÖ API endpoints (—á–µ—Ä–µ–∑ Edge Functions)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (—á–µ—Ä–µ–∑ pg_cron)

### ‚ö†Ô∏è –ù–£–ñ–ù–û –ü–ï–†–ï–ü–ò–°–ê–¢–¨:
- ‚ö†Ô∏è –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É —Å Java –Ω–∞ TypeScript (Edge Functions)
- ‚ö†Ô∏è –ù–æ –ª–æ–≥–∏–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–π –∂–µ!

### üí∞ –°–¢–û–ò–ú–û–°–¢–¨:
- –ë–µ—Å–ø–ª–∞—Ç–Ω–æ: 500MB –ë–î, 2GB bandwidth
- Pro: $25/–º–µ—Å - 8GB –ë–î, 50GB bandwidth

---

## –í–´–í–û–î:

**–î–∞, Supabase –º–æ–∂–µ—Ç –∑–∞–º–µ–Ω–∏—Ç—å Java Backend!**

–ù–æ –Ω—É–∂–Ω–æ:
1. –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –Ω–∞ TypeScript (Edge Functions)
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å PostgreSQL —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Supabase Client SDK –≤ iOS

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ú–µ–Ω—å—à–µ –∫–æ–¥–∞
- –ü—Ä–æ—â–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –ú–µ–Ω—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—è
- –ù—É–∂–Ω–æ –∑–Ω–∞—Ç—å TypeScript
- Vendor lock-in
