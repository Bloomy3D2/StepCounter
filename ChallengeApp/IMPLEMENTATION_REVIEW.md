# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ MVP - –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:

1. ‚úÖ **UserProfileResponse** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `honestStreak` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º CodingKey
2. ‚úÖ **getUserProfile** ‚Äî —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–∞–µ—Ç `honestStreak` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ User
3. ‚úÖ **failChallenge** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `userId` (—É–±—Ä–∞–Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–∞)
4. ‚úÖ **RootView** ‚Äî —É–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–µ–ª–ª–µ–Ω–¥–∂–µ–π —Å –æ–∂–∏–¥–∞–Ω–∏–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
5. ‚úÖ **QuickStartView** ‚Äî —É–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ onChange

---

## üìã –î–ï–¢–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê

### 1. SplashView ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –ù–æ–≤—ã–π –¥–∏–∑–∞–π–Ω —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º "target"
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç "–°—Ç–∞–≤–∫–∞ –Ω–∞ —Å–µ–±—è"
- ‚úÖ –°–ª–æ–≥–∞–Ω "–°–æ—Ä–≤–∞–ª—Å—è ‚Äî –ø–ª–∞—Ç–∏—à—å. –í—ã–¥–µ—Ä–∂–∞–ª ‚Äî –∑–∞–±–∏—Ä–∞–µ—à—å –¥–µ–Ω—å–≥–∏."
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å" —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
- ‚úÖ –í—ã–∑–æ–≤ `appState.autoSignIn()` –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 2. AppState.autoSignIn() ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –ú–µ—Ç–æ–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–µ—Å—Å–∏–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–æ–Ω–∏–º–Ω–æ–π —Å–µ—Å—Å–∏–∏ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏
- ‚úÖ Fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 3. RootView ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –£–±—Ä–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `isOnboardingCompleted`
- ‚úÖ –õ–æ–≥–∏–∫–∞ –ø–æ–∫–∞–∑–∞ Quick Start
- ‚úÖ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π —á–µ–ª–ª–µ–Ω–¥–∂–µ–π
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `DispatchQueue.main.asyncAfter` –≤ async —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî –∑–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `withAnimation` –Ω–∞–ø—Ä—è–º—É—é

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

---

### 4. QuickStartView ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `@EnvironmentObject`
- ‚úÖ –ü–æ–∏—Å–∫ Quick Start —á–µ–ª–ª–µ–Ω–¥–∂–∞ (1 –¥–µ–Ω—å, 299‚ÇΩ)
- ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –∫ PaymentView
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π"
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ Loading state

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 5. –ß–µ—Å—Ç–Ω–∞—è —Å–µ—Ä–∏—è –≤ –ë–î ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ SQL –º–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –ü–æ–ª–µ `honest_streak` –¥–æ–±–∞–≤–ª–µ–Ω–æ
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ `increment_honest_streak` –∏ `reset_honest_streak` —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ SECURITY DEFINER –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é

---

### 6. –ú–æ–¥–µ–ª—å User ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –ü–æ–ª–µ `honestStreak: Int` –¥–æ–±–∞–≤–ª–µ–Ω–æ
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Codable
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π init

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 7. SupabaseManager ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –ú–µ—Ç–æ–¥ `incrementHonestStreak()` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ –ú–µ—Ç–æ–¥ `resetHonestStreak()` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª `SupabaseManagerProtocol`
- ‚úÖ UserProfileResponse –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è `honest_streak`
- ‚úÖ getUserProfile –ø–µ—Ä–µ–¥–∞–µ—Ç `honestStreak` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ User

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 8. ChallengeManager ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Å—Ç–Ω–æ–π —Å–µ—Ä–∏–∏ –ø—Ä–∏ `completeDay`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Å—Ç–Ω–æ–π —Å–µ—Ä–∏–∏ –ø—Ä–∏ `failChallenge`
- ‚úÖ –ú–µ—Ç–æ–¥ `updateHonestStreak()` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `userId` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 9. ActiveChallengeView ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –¢–∞–π–º–µ—Ä –¥–æ –∫–æ–Ω—Ü–∞ –¥–Ω—è –¥–æ–±–∞–≤–ª–µ–Ω
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Timer.publish`
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ "HH:MM:SS"
- ‚úÖ –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∞–π–º–µ—Ä–∞ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏/–ø—Ä–æ–≤–∞–ª–µ
- ‚úÖ –ö–Ω–æ–ø–∫–∏ "–í—ã–ø–æ–ª–Ω–∏–ª" –∏ "–ü—Ä–æ–≤–∞–ª–∏–ª—Å—è" ‚Äî –±–æ–ª—å—à–∏–µ, –ø–æ —Ü–µ–Ω—Ç—Ä—É
- ‚úÖ –£–±—Ä–∞–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∞—è –∫–Ω–æ–ø–∫–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### –ü—Ä–æ–±–ª–µ–º–∞ 1: UserProfileResponse –Ω–µ —Å–æ–¥–µ—Ä–∂–∞–ª honestStreak
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
```swift
private struct UserProfileResponse: Codable {
    // ...
    let honestStreak: Int
    
    enum CodingKeys: String, CodingKey {
        // ...
        case honestStreak = "honest_streak"
    }
}
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: getUserProfile –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª honestStreak
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
```swift
return User(
    // ...
    honestStreak: profile.honestStreak
)
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ userId –≤ failChallenge
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
```swift
// –ë—ã–ª–æ: if let userId = userChallenge.userId as String?
// –°—Ç–∞–ª–æ:
try await updateHonestStreak(userId: userChallenge.userId, isHonest: true)
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: RootView –Ω–µ –∂–¥–∞–ª –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
```swift
guard appState.currentUser != nil else {
    // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    return
}
```

---

## üìä –ú–ê–°–®–¢–ê–ë–ò–†–£–ï–ú–û–°–¢–¨

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚úÖ
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ –ë–î –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ SECURITY DEFINER –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

### –ö–æ–¥ ‚úÖ
- ‚úÖ Dependency Injection
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ Async/await

### UI/UX ‚úÖ
- ‚úÖ –¢–µ–º–Ω–∞—è —Ç–µ–º–∞
- ‚úÖ –ê–Ω–∏–º–∞—Ü–∏–∏
- ‚úÖ –ö—Ä—É–ø–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
- ‚úÖ Loading states
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

## ‚ö†Ô∏è –ò–ó–í–ï–°–¢–ù–´–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø

1. **Quick Start —á–µ–ª–ª–µ–Ω–¥–∂** ‚Äî –ø–æ–∫–∞ –∏—â–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –≤ –ë–î, —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Edge Function –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–∑–∂–µ
2. **–ù–∞–≤–∏–≥–∞—Ü–∏—è –∏–∑ Quick Start** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —É–ª—É—á—à–µ–Ω–∏–µ –¥–ª—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
3. **–ß–µ—Å—Ç–Ω–∞—è —Å–µ—Ä–∏—è** ‚Äî –ø–æ–∫–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª–∞ (—ç—Ç–æ –±—É–¥–µ—Ç –≤ LAYER 2)

---

## ‚úÖ –§–ò–ù–ê–õ–¨–ù–´–ô –í–ï–†–î–ò–ö–¢

### –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã ‚úÖ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:**
- ‚úÖ –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –Ω–∞ –º–µ—Å—Ç–µ
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å —É—á—Ç–µ–Ω–∞
- ‚úÖ UI/UX —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å SQL –º–∏–≥—Ä–∞—Ü–∏—é (`add-honest-streak.sql`)
2. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π Quick Start —á–µ–ª–ª–µ–Ω–¥–∂ –≤ –ë–î
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å flow: Splash ‚Üí Quick Start ‚Üí –û–ø–ª–∞—Ç–∞ ‚Üí –ê–∫—Ç–∏–≤–Ω—ã–π —á–µ–ª–ª–µ–Ω–¥–∂

---

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**
