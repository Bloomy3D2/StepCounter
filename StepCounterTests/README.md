# üß™ StepCounter Tests

## üìã –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è StepCounter. –¢–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ **—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**, –∞ –Ω–µ –Ω–∞ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é**
   - –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã –≤—ã–∑—ã–≤–∞—é—Ç—Å—è)

2. **–ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤**
   - –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `TestStorageManager` –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
   - –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ `tearDown`

3. **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤**
   - –°–∏—Å—Ç–µ–º–∞ —É—Ä–æ–≤–Ω–µ–π –∏ XP
   - –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
   - Premium —Ñ—É–Ω–∫—Ü–∏–∏
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
StepCounterTests/
‚îú‚îÄ‚îÄ TestHelpers.swift              # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –º–æ–∫–∏
‚îú‚îÄ‚îÄ LevelManagerTests.swift         # –¢–µ—Å—Ç—ã —Å–∏—Å—Ç–µ–º—ã —É—Ä–æ–≤–Ω–µ–π
‚îú‚îÄ‚îÄ AchievementManagerTests.swift   # –¢–µ—Å—Ç—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
‚îú‚îÄ‚îÄ PetManagerTests.swift           # –¢–µ—Å—Ç—ã –ø–∏—Ç–æ–º—Ü–µ–≤
‚îú‚îÄ‚îÄ SubscriptionManagerTests.swift # –¢–µ—Å—Ç—ã Premium –ø–æ–¥–ø–∏—Å–æ–∫
‚îú‚îÄ‚îÄ TournamentManagerTests.swift    # –¢–µ—Å—Ç—ã —Ç—É—Ä–Ω–∏—Ä–æ–≤
‚îú‚îÄ‚îÄ PrivacyConsentManagerTests.swift # –¢–µ—Å—Ç—ã —Å–æ–≥–ª–∞—Å–∏—è –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ IntegrationTests.swift         # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
```

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –í Xcode:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç `StepCounter.xcodeproj`
2. –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ö–µ–º—É `StepCounterTests`
3. –ù–∞–∂–º–∏—Ç–µ `Cmd + U` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
4. –ò–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Run" —Ä—è–¥–æ–º —Å –Ω–∏–º

### –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
xcodebuild test -scheme StepCounter -destination 'platform=iOS Simulator,name=iPhone 15'

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
xcodebuild test -scheme StepCounter -destination 'platform=iOS Simulator,name=iPhone 15' -only-testing:StepCounterTests/LevelManagerTests/testAddXPIncreasesTotalXP
```

## üìä –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞

–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞:

1. –í Xcode: `Product` ‚Üí `Scheme` ‚Üí `Edit Scheme`
2. –í—ã–±–µ—Ä–∏—Ç–µ `Test` ‚Üí `Options`
3. –í–∫–ª—é—á–∏—Ç–µ `Code Coverage`
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã
5. –û—Ç–∫—Ä–æ–π—Ç–µ `Report Navigator` (Cmd + 9)
6. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ç–µ—Å—Ç –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É `Coverage`

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ target

–ï—Å–ª–∏ —Ç–µ—Å—Ç–æ–≤—ã–π target –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω:

1. –í Xcode: `File` ‚Üí `New` ‚Üí `Target`
2. –í—ã–±–µ—Ä–∏—Ç–µ `Unit Testing Bundle`
3. –ù–∞–∑–æ–≤–∏—Ç–µ –µ–≥–æ `StepCounterTests`
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω —Å–≤—è–∑–∞–Ω —Å –æ—Å–Ω–æ–≤–Ω—ã–º target `StepCounter`

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Main Actor**: –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ `@MainActor`, –ø–æ—ç—Ç–æ–º—É —Ç–µ—Å—Ç—ã —Ç–∞–∫–∂–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å `@MainActor`

2. **Singleton**: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç singleton –ø–∞—Ç—Ç–µ—Ä–Ω (`SubscriptionManager.shared`). –í —Ç–µ—Å—Ç–∞—Ö –º—ã —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ `tearDown`

3. **UserDefaults**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `TestStorageManager` –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

4. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å**: –î–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `waitForAsync()` –∏–ª–∏ `waitForMainActor()`

## üìù –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Å–ª–µ–¥—É–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:

```swift
@MainActor
final class NewManagerTests: XCTestCase {
    
    var manager: NewManager!
    
    override func setUp() {
        super.setUp()
        manager = NewManager()
    }
    
    override func tearDown() {
        manager = nil
        super.tearDown()
    }
    
    /// –¢–µ—Å—Ç: –û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å
    func testExpectedBehavior() {
        // Given - –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        // When - –¥–µ–π—Å—Ç–≤–∏–µ
        // Then - –æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    }
}
```

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Å—Ç—ã –º–æ–≥—É—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ HealthKit –≤ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ
- –¢–µ—Å—Ç—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞—Ç—ã, –º–æ–≥—É—Ç –±—ã—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é –≤—Ä–µ–º–µ–Ω–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [TESTING_STRATEGY.md](../StepCounter/TESTING_STRATEGY.md) - –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- [Apple Testing Documentation](https://developer.apple.com/documentation/xctest)
